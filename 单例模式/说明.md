### 什么是单例模式

作为创建对象的模式，单例模式确保某一个类只有一个对象，而且自行实例化并向整个系统全局地提供这个实例。它不会创建实例副本，而是会向单例类内部存储的实例返回一个引用。

### 单例模式的特点

1. 需要一个保存类的唯一实例的静态成员变量
2. 构造函数和克隆函数必须声明为私有的，防止外部程序new类从而失去单例模式的意义
3. 必须提供一个访问这个实例的公共的静态方法（通常为getInstance方法），从而返回唯一实例的一个引用 

### 为什么要使用单例模式

多数人都是从单例模式的字面上的意思来理解它的用途, 认为这是对系统资源的节省, 可以避免重复实例化, 是一种"计划生育".   而PHP每次执行完页面都是会从内存中清理掉所有的资源. 因而PHP中的单例实际每次运行都是需要重新实例化的, 这样就失去了单例重复实例化的意义了. 单单从这个方面来说, PHP的单例的确有点让各位失望. 但是单例仅仅只有这个功能和应用吗? 答案是否定的,我们一起来看看。

php的应用主要在于数据库应用, 所以一个应用中会存在大量的数据库操作, 在使用面向对象的方式开发时(废话), 如果使用单例模式, 则可以避免大量的new 操作消耗的资源。
如果系统中需要有一个类来全局控制某些配置信息, 那么使用单例模式可以很方便的实现. 这个可以参看zend Framework的FrontController部分。
在一次页面请求中, 便于进行调试, 因为所有的代码(例如数据库操作类db)都集中在一个类中, 我们可以在类中设置钩子, 输出日志，从而避免到处var_dump, echo。

1. PHP缺点

   PHP语言是一种解释型的脚本语言，这种运行机制使得每个PHP页面被解释执行后，所有的相关资源都会被回收。也就是说，PHP在语言级别上没有办法让某个对象常驻内存，这和asp.net、Java等编译型是不同的，比如在Java中单例会一直存在于整个应用程序的生命周期里，变量是跨页面级的，真正可以做到这个实例在应用程序生命周期中的唯一性。然而在PHP中，所有的变量无论是全局变量还是类的静态成员，都是页面级的，每次页面被执行时，都会重新建立新的对象，都会在页面执行完毕后被清空，这样似乎PHP单例模式就没有什么意义了，所以PHP单例模式我觉得只是针对单次页面级请求时出现多个应用场景并需要共享同一对象资源时是非常有意义的。

2. 单例模式在PHP中的应用场合

   * 应用程序与数据库交互

     一个应用中会存在大量的数据库操作，比如过数据库句柄来连接数据库这一行为，使用单例模式可以避免大量的new操作，因为每一次new操作都会消耗内存资源和系统资源

   * 控制配置信息

     如果系统中需要有一个类来全局控制某些配置信息, 那么使用单例模式可以很方便的实现

示例：

	<?php
	class Db{
	  private static $dbObj = NULL;
	  private function __construct(){
	
	  }
	  private function __clone(){
	
	  }
	  public static function getInstance()
	  {
	      if(self::$dbObj === NULL){
	          self::$dbObj = new self();
	      }
	      return self::$dbObj;
	  }
	  public function getName(){
	      echo 'this is a singleton pattern';
	  }
	}
	Db::getInstance()->getName();
文章来源：[云栖社区](https://yq.aliyun.com/ziliao/9254)

